<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIè®¾è®¡å·¥ä½œå®¤ - Demo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f0f2f5; }
        
        .header { background: #1890ff; color: white; padding: 16px 24px; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { font-size: 20px; }
        
        .container { display: flex; height: calc(100vh - 64px); }
        
        /* Left Panel - DAG */
        .dag-panel { flex: 1; background: #fafafa; position: relative; overflow: hidden; }
        .dag-canvas { width: 100%; height: 100%; position: relative; }
        
        .node {
            position: absolute;
            width: 180px;
            background: white;
            border: 2px solid #d9d9d9;
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .node:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .node.active { border-color: #1890ff; background: #e6f7ff; }
        .node.completed { border-color: #52c41a; }
        .node.processing { border-color: #1890ff; animation: pulse 2s infinite; }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(24, 144, 255, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(24, 144, 255, 0); }
        }
        
        .node-icon { font-size: 24px; margin-bottom: 8px; }
        .node-title { font-weight: bold; margin-bottom: 4px; }
        .node-desc { font-size: 12px; color: #666; }
        .node-status { margin-top: 8px; font-size: 12px; }
        
        .edge {
            position: absolute;
            height: 2px;
            background: #1890ff;
            transform-origin: left center;
        }
        
        /* Right Panel - Controls */
        .control-panel { width: 300px; background: white; border-left: 1px solid #e8e8e8; padding: 20px; overflow-y: auto; }
        .control-panel h3 { margin-bottom: 16px; color: #333; }
        
        .view-btn {
            width: 100%;
            padding: 12px;
            margin-bottom: 8px;
            border: 1px solid #d9d9d9;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s;
        }
        .view-btn:hover { border-color: #1890ff; color: #1890ff; }
        .view-btn.active { background: #1890ff; color: white; border-color: #1890ff; }
        
        .progress-bar { height: 8px; background: #f0f0f0; border-radius: 4px; overflow: hidden; margin: 16px 0; }
        .progress-fill { height: 100%; background: #1890ff; transition: width 0.3s; }
        
        /* 3D View Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-overlay.active { display: flex; }
        
        .modal-content {
            background: white;
            width: 90vw;
            height: 90vh;
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .modal-header {
            padding: 16px 24px;
            background: #1890ff;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-body {
            flex: 1;
            display: flex;
        }
        
        .view-3d {
            flex: 1;
            background: linear-gradient(to bottom, #87CEEB, #E0F6FF);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .room-preview {
            width: 600px;
            height: 400px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .room-visual {
            flex: 1;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 64px;
            position: relative;
        }
        
        .room-furniture {
            position: absolute;
            background: #8B4513;
            border-radius: 4px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .room-furniture:hover { transform: scale(1.05); }
        
        .sofa {
            width: 120px;
            height: 60px;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: #D2691E;
        }
        
        .tv {
            width: 80px;
            height: 10px;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
        }
        
        .table {
            width: 60px;
            height: 60px;
            bottom: 100px;
            right: 100px;
            background: #DEB887;
            border-radius: 50%;
        }
        
        .room-info {
            padding: 16px;
            background: white;
            border-top: 1px solid #e8e8e8;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }
        
        .toolbar {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
        }
        .toolbar button {
            padding: 8px 16px;
            border: 1px solid #d9d9d9;
            background: white;
            border-radius: 4px;
            cursor: pointer;
        }
        .toolbar button.active {
            background: #1890ff;
            color: white;
            border-color: #1890ff;
        }
        
        .log-panel {
            background: #1a1a2e;
            color: #52c41a;
            padding: 12px;
            font-family: monospace;
            font-size: 12px;
            height: 120px;
            overflow-y: auto;
            margin-top: 16px;
            border-radius: 4px;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-left: 8px;
        }
        .status-pending { background: #f0f0f0; color: #666; }
        .status-processing { background: #e6f7ff; color: #1890ff; }
        .status-completed { background: #f6ffed; color: #52c41a; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ  AIè®¾è®¡å·¥ä½œå®¤</h1>
        <div>
            <span id="project-name">ä¸‡ç§‘åŸ 105ã¡</span>
            <span class="status-badge status-processing">å¤„ç†ä¸­ 65%</span>
        </div>
    </div>
    
    <div class="container">
        <!-- DAG Canvas -->
        <div class="dag-panel">
            <div class="toolbar" style="padding: 16px;">
                <button onclick="startProcess()" style="background: #52c41a; color: white;">â–¶ å¼€å§‹</button>
                <button onclick="pauseProcess()">â¸ æš‚åœ</button>
                <button onclick="resetProcess()">â†º é‡ç½®</button>
            </div>
            <div class="dag-canvas" id="dagCanvas">
                <!-- Nodes will be generated by JS -->
            </div>
        </div>
        
        <!-- Control Panel -->
        <div class="control-panel">
            <h3>ğŸ“ æˆ·å‹å›¾</h3>
            <div style="background: #f5f5f5; padding: 16px; border-radius: 8px; margin-bottom: 16px; text-align: center;">
                <div style="font-size: 48px;">ğŸ </div>
                <div style="margin-top: 8px; font-weight: bold;">ä¸‰å®¤ä¸¤å…</div>
                <div style="color: #666; font-size: 12px;">105ã¡ Â· å—åŒ—é€šé€</div>
            </div>
            
            <h3>ğŸ¨ é£æ ¼é¢„è§ˆ</h3>
            <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px;">
                <button class="view-btn active" onclick="changeStyle('modern')">ç°ä»£ç®€çº¦</button>
                <button class="view-btn" onclick="changeStyle('nordic')">åŒ—æ¬§é£</button>
                <button class="view-btn" onclick="changeStyle('chinese')">æ–°ä¸­å¼</button>
                <button class="view-btn" onclick="changeStyle('luxury')">è½»å¥¢</button>
            </div>
            
            <h3>ğŸ‘ï¸ 3Dæ¼«æ¸¸è§†è§’</h3>
            <button class="view-btn active" onclick="open3DView('bird')">ğŸ¦… é¸Ÿç°å›¾</button>
            <button class="view-btn" onclick="open3DView('sofa')">ğŸ›‹ï¸ æ²™å‘è§†è§’</button>
            <button class="view-btn" onclick="open3DView('tv')">ğŸ“º ç”µè§†è§†è§’</button>
            <button class="view-btn" onclick="open3DView('entrance')">ğŸšª å…¥å£è§†è§’</button>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 65%"></div>
            </div>
            <div style="text-align: center; color: #666; font-size: 12px;">
                æ€»ä½“è¿›åº¦: <span id="progressText">65%</span>
            </div>
            
            <div class="log-panel" id="logPanel">
                <div>[12:00:00] å¼€å§‹å¤„ç†...</div>
                <div>[12:00:01] æˆ·å‹è§£æå®Œæˆ âœ“</div>
                <div>[12:00:05] é£æ ¼æ¸²æŸ“ä¸­...</div>
                <div>[12:00:10] æ­£åœ¨ç”Ÿæˆå®¢å…æ•ˆæœå›¾</div>
            </div>
        </div>
    </div>
    
    <!-- 3D View Modal -->
    <div class="modal-overlay" id="modal3D">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ¬ 3Dæ¼«æ¸¸ - <span id="viewName">é¸Ÿç°å›¾</span></h2>
                <button class="close-btn" onclick="close3DView()">Ã—</button>
            </div>
            <div class="modal-body">
                <div style="width: 200px; background: #fafafa; padding: 16px; border-right: 1px solid #e8e8e8;">
                    <h4 style="margin-bottom: 12px;">åˆ‡æ¢è§†è§’</h4>
                    <button class="view-btn" onclick="switchView('bird')">ğŸ¦… é¸Ÿç°å›¾</button>
                    <button class="view-btn" onclick="switchView('sofa')">ğŸ›‹ï¸ æ²™å‘è§†è§’</button>
                    <button class="view-btn" onclick="switchView('tv')">ğŸ“º ç”µè§†è§†è§’</button>
                    <button class="view-btn" onclick="switchView('entrance')">ğŸšª å…¥å£</button>
                    <button class="view-btn" onclick="switchView('kitchen')">ğŸ³ å¨æˆ¿</button>
                    
                    <h4 style="margin: 16px 0 12px;">é£æ ¼åˆ‡æ¢</h4>
                    <button class="view-btn" onclick="changeRoomStyle('modern')">ç°ä»£ç®€çº¦</button>
                    <button class="view-btn" onclick="changeRoomStyle('nordic')">åŒ—æ¬§é£</button>
                    <button class="view-btn" onclick="changeRoomStyle('luxury')">è½»å¥¢</button>
                </div>
                <div class="view-3d">
                    <div class="room-preview">
                        <div class="room-visual" id="roomVisual">
                            <div class="room-furniture sofa" onclick="clickFurniture('sofa')" title="æ²™å‘"></div>
                            <div class="room-furniture tv" onclick="clickFurniture('tv')" title="ç”µè§†"></div>
                            <div class="room-furniture table" onclick="clickFurniture('table')" title="èŒ¶å‡ "></div>
                            <div style="position: absolute; top: 20px; left: 20px; font-size: 14px; background: rgba(0,0,0,0.7); color: white; padding: 4px 8px; border-radius: 4px;">
                                ç‚¹å‡»å®¶å…·æŸ¥çœ‹è¯¦æƒ…
                            </div>
                        </div>
                        <div class="room-info">
                            <h3>å®¢å… - <span id="roomStyle">ç°ä»£ç®€çº¦</span></h3>
                            <p style="color: #666; font-size: 14px; margin-top: 4px;">
                                35ã¡ Â· å—å‘é‡‡å…‰ Â· å½“å‰è§†è§’: <span id="currentView">é¸Ÿç°å›¾</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DAG Nodes Configuration
        const nodes = [
            { id: 'input', label: 'æˆ·å‹å›¾è¾“å…¥', icon: 'ğŸ“', desc: 'å·²åŠ è½½ 5å¼ å›¾ç‰‡', x: 50, y: 150, status: 'completed' },
            { id: 'analysis', label: 'æˆ·å‹è§£æ', icon: 'ğŸ”', desc: 'è¯†åˆ«å®Œæˆ', x: 300, y: 150, status: 'completed' },
            { id: 'style', label: 'é£æ ¼æ¸²æŸ“', icon: 'ğŸ¨', desc: 'ç”Ÿæˆä¸­ 65%', x: 550, y: 50, status: 'processing' },
            { id: 'cad', label: 'CADå›¾çº¸', icon: 'ğŸ“', desc: 'ç­‰å¾…ä¸­', x: 550, y: 150, status: 'pending' },
            { id: 'materials', label: 'ææ–™åŒ¹é…', icon: 'ğŸ›’', desc: 'ç­‰å¾…ä¸­', x: 550, y: 250, status: 'pending' },
            { id: 'output', label: 'è¾“å‡ºäº¤ä»˜', icon: 'ğŸ“¦', desc: 'ç­‰å¾…ä¸­', x: 800, y: 150, status: 'pending' }
        ];
        
        // Render DAG
        function renderDAG() {
            const canvas = document.getElementById('dagCanvas');
            canvas.innerHTML = '';
            
            nodes.forEach((node, index) => {
                const nodeEl = document.createElement('div');
                nodeEl.className = `node ${node.status}`;
                nodeEl.style.left = node.x + 'px';
                nodeEl.style.top = node.y + 'px';
                nodeEl.onclick = () => clickNode(node);
                
                nodeEl.innerHTML = `
                    <div class="node-icon">${node.icon}</div>
                    <div class="node-title">${node.label}</div>
                    <div class="node-desc">${node.desc}</div>
                    <div class="node-status">
                        ${node.status === 'completed' ? 'âœ… å·²å®Œæˆ' : 
                          node.status === 'processing' ? 'ğŸ”„ å¤„ç†ä¸­...' : 'â³ ç­‰å¾…ä¸­'}
                    </div>
                `;
                
                canvas.appendChild(nodeEl);
                
                // Draw edges
                if (index < nodes.length - 1 && index !== 2 && index !== 3) {
                    const nextNode = nodes[index + 1];
                    drawEdge(canvas, node, nextNode);
                }
                if (index === 1) {
                    // From analysis to style/cad/materials
                    drawEdge(canvas, node, nodes[2]);
                    drawEdge(canvas, node, nodes[3]);
                    drawEdge(canvas, node, nodes[4]);
                }
                if (index >= 2 && index <= 4) {
                    // To output
                    drawEdge(canvas, node, nodes[5]);
                }
            });
        }
        
        function drawEdge(canvas, from, to) {
            const edge = document.createElement('div');
            edge.className = 'edge';
            const dx = to.x - from.x - 180;
            const dy = to.y - from.y;
            const length = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * 180 / Math.PI;
            
            edge.style.width = length + 'px';
            edge.style.left = (from.x + 180) + 'px';
            edge.style.top = (from.y + 40) + 'px';
            edge.style.transform = `rotate(${angle}deg)`;
            
            canvas.appendChild(edge);
        }
        
        function clickNode(node) {
            document.querySelectorAll('.node').forEach(n => n.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            addLog(`[${new Date().toLocaleTimeString()}] ç‚¹å‡»èŠ‚ç‚¹: ${node.label}`);
            
            if (node.id === 'style' || node.id === 'output') {
                open3DView('bird');
            }
        }
        
        function addLog(message) {
            const logPanel = document.getElementById('logPanel');
            const div = document.createElement('div');
            div.textContent = message;
            logPanel.appendChild(div);
            logPanel.scrollTop = logPanel.scrollHeight;
        }
        
        // 3D View Functions
        function open3DView(view) {
            document.getElementById('modal3D').classList.add('active');
            switchView(view);
        }
        
        function close3DView() {
            document.getElementById('modal3D').classList.remove('active');
        }
        
        function switchView(view) {
            const viewNames = {
                'bird': 'é¸Ÿç°å›¾',
                'sofa': 'æ²™å‘è§†è§’',
                'tv': 'ç”µè§†è§†è§’',
                'entrance': 'å…¥å£',
                'kitchen': 'å¨æˆ¿'
            };
            
            document.getElementById('viewName').textContent = viewNames[view];
            document.getElementById('currentView').textContent = viewNames[view];
            
            // Update button states
            document.querySelectorAll('.modal-body .view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Simulate view change
            const visual = document.getElementById('roomVisual');
            visual.style.opacity = '0.5';
            setTimeout(() => {
                visual.style.opacity = '1';
            }, 200);
        }
        
        function changeStyle(style) {
            document.querySelectorAll('.control-panel .view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            const styleNames = {
                'modern': 'ç°ä»£ç®€çº¦',
                'nordic': 'åŒ—æ¬§é£',
                'chinese': 'æ–°ä¸­å¼',
                'luxury': 'è½»å¥¢'
            };
            
            addLog(`[${new Date().toLocaleTimeString()}] åˆ‡æ¢é£æ ¼: ${styleNames[style]}`);
        }
        
        function changeRoomStyle(style) {
            const styleNames = {
                'modern': 'ç°ä»£ç®€çº¦',
                'nordic': 'åŒ—æ¬§é£',
                'luxury': 'è½»å¥¢'
            };
            document.getElementById('roomStyle').textContent = styleNames[style];
            
            // Change room background color
            const colors = {
                'modern': 'linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%)',
                'nordic': 'linear-gradient(135deg, #faf8f5 0%, #f0ebe3 100%)',
                'luxury': 'linear-gradient(135deg, #f8f8f8 0%, #e8e0d5 100%)'
            };
            document.getElementById('roomVisual').style.background = colors[style];
        }
        
        function clickFurniture(name) {
            const names = { 'sofa': 'æ²™å‘', 'tv': 'ç”µè§†', 'table': 'èŒ¶å‡ ' };
            alert(`ç‚¹å‡»äº†: ${names[name]}\n\nå¯ä»¥åœ¨è¿™é‡Œæ˜¾ç¤ºå®¶å…·è¯¦æƒ…ã€æ›´æ¢æè´¨ç­‰æ“ä½œã€‚`);
        }
        
        // Process Control
        let progress = 65;
        let isRunning = true;
        
        function startProcess() {
            isRunning = true;
            addLog('[ç³»ç»Ÿ] å¼€å§‹å¤„ç†æµç¨‹');
            simulateProgress();
        }
        
        function pauseProcess() {
            isRunning = false;
            addLog('[ç³»ç»Ÿ] å·²æš‚åœ');
        }
        
        function resetProcess() {
            isRunning = false;
            progress = 0;
            updateProgress(0);
            addLog('[ç³»ç»Ÿ] å·²é‡ç½®');
        }
        
        function simulateProgress() {
            if (!isRunning || progress >= 100) return;
            
            progress += Math.random() * 5;
            if (progress > 100) progress = 100;
            
            updateProgress(progress);
            
            if (progress < 100) {
                setTimeout(simulateProgress, 1000);
            } else {
                addLog('[ç³»ç»Ÿ] å¤„ç†å®Œæˆï¼');
            }
        }
        
        function updateProgress(value) {
            document.getElementById('progressBar').style.width = value + '%';
            document.getElementById('progressText').textContent = Math.floor(value) + '%';
        }
        
        // Initialize
        renderDAG();
        
        // Close modal on outside click
        document.getElementById('modal3D').onclick = function(e) {
            if (e.target === this) close3DView();
        };
    </script>
</body>
</html>